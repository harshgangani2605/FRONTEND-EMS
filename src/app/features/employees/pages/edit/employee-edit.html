<div class="form-container">

  <h2>Edit Employee</h2>

  <form #form="ngForm" (ngSubmit)="update(form)">

    <!-- Full Name -->
    <label class="label">Full Name <span class="required">*</span></label>
    <input 
      type="text"
      class="form-input"
      name="fullName"
      [(ngModel)]="model.fullName"
      required
      minlength="3"
      #fullName="ngModel"
    />

    <span class="error" *ngIf="fullName.touched && fullName.invalid">
      <span *ngIf="fullName.errors?.['required']">Full Name is required</span>
      <span *ngIf="fullName.errors?.['minlength']">Minimum 3 characters</span>
    </span>

    <span class="error" *ngIf="errors.fullName">{{ errors.fullName }}</span>


    <!-- Email -->
    <label class="label">Email <span class="required">*</span></label>
    <input 
      type="email"
      class="form-input"
      name="email"
      [(ngModel)]="model.email"
      required
      email
      #email="ngModel"
    />

    <span class="error" *ngIf="email.touched && email.invalid">
      <span *ngIf="email.errors?.['required']">Email is required</span>
      <span *ngIf="email.errors?.['email']">Invalid email format</span>
    </span>

    <span class="error" *ngIf="errors.email">{{ errors.email }}</span>


    <!-- Salary -->
    <label class="label">Salary <span class="required">*</span></label>
    <input 
      type="number"
      class="form-input"
      name="salary"
      [(ngModel)]="model.salary"
      min="0"
      required
      #salary="ngModel"
    />

    <span class="error" *ngIf="salary.touched && salary.invalid">
      <span *ngIf="salary.errors?.['required']">Salary is required</span>
      <span *ngIf="salary.errors?.['min']">Salary cannot be negative</span>
    </span>

    <span class="error" *ngIf="errors.salary">{{ errors.salary }}</span>


    <!-- Joined On -->
    <label class="label">Joined On <span class="required">*</span></label>
    <input 
      type="date"
      class="form-input"
      name="joinedOn"
      [(ngModel)]="model.joinedOn"
      [max]="today"
      required
      #joinedOn="ngModel"
    />

    <span class="error" *ngIf="joinedOn.touched && joinedOn.invalid">
      <span *ngIf="joinedOn.errors?.['required']">Joining date is required</span>
      <span *ngIf="joinedOn.errors?.['max']">Future date not allowed</span>
    </span>

    <span class="error" *ngIf="errors.joinedOn">{{ errors.joinedOn }}</span>


    <!-- Department -->
    <label class="label">Department <span class="required">*</span></label>
    <select 
      class="form-input"
      name="departmentId"
      [(ngModel)]="model.departmentId"
      required
      #departmentId="ngModel"
    >
      <option value="">Select Department</option>
      <option *ngFor="let d of departments" [value]="d.id">{{ d.name }}</option>
    </select>

    <span class="error" *ngIf="departmentId.touched && departmentId.invalid">
      Department is required
    </span>


    <!-- Skills -->
    <label class="label">Skills <span class="required">*</span></label>

    <div class="skills-box">
      <label class="skill-item" *ngFor="let skill of skills">
        <input 
          type="checkbox"
          [checked]="model.skillIds.includes(skill.id)"
          (change)="toggleSkill(skill.id, $event)"
        />
        <span>{{ skill.name }}</span>
      </label>
    </div>

    <span class="error" *ngIf="errors.skillIds">{{ errors.skillIds }}</span>


    <!-- FORM LEVEL ERROR -->
    <span class="error" *ngIf="errors.form">{{ errors.form }}</span>

    <!-- Submit -->
    <button type="submit" class="save-btn">Update</button>

  </form>

</div>
